---
title: "CSSS508, Week 9"
subtitle: "Mapping"
author: "Chuck Lanfear"
date: "Nov 21, 2018<br>Updated: `r gsub(' 0', ' ', format(Sys.Date(), format='%b %d, %Y'))`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: xaringan-themer.css
    nature:
      highlightStyle: tomorrow-night-bright
      highlightLines: true
      countIncrementalSlides: false
      titleSlideClass: ["center","top"]
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(comment = "##")
```

```{r xaringan-themer, include = FALSE}
library(xaringanthemer)

csss508css <- list(
     ".hljs-tomorrow-night-bright .hljs" = list(
        "background" = "#10102c",
        "border-radius"="5px"),
     ".remark-inline-code" = list(
        "background" = "#E0E0E0",
        "color" = "#10102c",
        "border-radius" = "3px",
        "padding" = "2px"),
     ".inverse .remark-inline-code" = list(
        "background" = "#10102c",
        "color" = "#ececf8",
        "border-radius" = "3px",
        "padding" = "2px"),
     ".smallish" = list("font-size" = "85%"),
     ".small" = list("font-size" = "75%"),
     ".smaller" = list("font-size" = "60%"),
     ".remark-code-line-highlighted" = list(
        "background-color" = "rgba(255,0,255,0.2)"),
     "sup" = list("font-size" = "14px"),
     "h1, h2, h3" = list(
        "margin-top"=".25em", 
        "margin-bottom"=".25em"),
     ".pull-left60" = list(
        "float" = "left",
        "width" = "58%" ),
     ".pull-right40" = list(
        "float" = "right",
        "width" = "38%" ),
     "a" = list("text-decoration" = "underline"),
     ".inverse a" = list("color" = "#cbd3a3"),
     "body" = list("line-height" = "1.4"),
     ".inverse" = list("background-image" = "url(https://clanfear.github.io/CSSS508/Lectures/img/UWCSSSBG1_white.svg)"),
     ".short" = list("height" = "30%"),
     ".image-50 img" = list("width" = "50%"),
     ".image-75 img" = list("width" = "75%"),
          ".image-full img" = list(
        "height" = "480px",
        "display"="block",
        "margin-left"="auto",
        "margin-right"="auto"),
     ".title-slide" = list("background-image" = "url(https://clanfear.github.io/CSSS508/Lectures/img/UWCSSSBG1_white.svg), url(https://clanfear.github.io/CSSS508/Lectures/img/title_slide_img.png)",
                           "background-position" = "center center, center bottom",
                           "background-size" = "contain, contain")
    )
 
mono_accent(base_color = "#342c5c",
            code_font_google = google_font("Fira Mono"),
            header_font_google = google_font("Quattrocento"),
            extra_css = csss508css,
            title_slide_background_image = "https://raw.githubusercontent.com/clanfear/CSSS508/master/Lectures/img/title_slide_img.png",
            title_slide_background_position = "bottom",
            title_slide_background_size = "contain",
            background_image = "https://clanfear.github.io/CSSS508/Lectures/img/UWCSSSBG1.svg"
)
```




# Today


* Mapping with raw `ggplot2` using coordinates
* Labeling points and using `ggrepel` to avoid overlaps
* `ggmap` for mashing up maps with `ggplot2`
* `sf`: [Simple Features](https://en.wikipedia.org/wiki/Simple_Features) geometry for R
* `tidycensus` for obtaining Census Bureau data

```{r}
library(ggplot2)
```

---
# Mapping in R: A quick plug

.pull-left[
![](img/bivand.jpg)
]

.pull-right[
If you are interested in mapping, GIS, and geospatial analysis in R, *acquire this book*.

You may also consider taking Jon Wakefield's **CSSS 554: Statistical Methods for Spatial Data**, however it is challenging and focuses more heavily on statistics than mapping.

Also, in most terms, CSDE offers workshops in GIS using [QGIS](https://qgis.org/en/site/) and/or ArcGIS.

I recommend QGIS because it is free, open-source software with an extensive feature set and large user community.
]

---

# Mapping in `ggplot2`

### Coordinates are just numbers!


---
# `sf`

```{r}
library(sf)
```

---
```{r, eval=FALSE}
load("seattle_tracts.RData")

ggplot(seattle_tracts, aes(fill=Experiment)) + 
  geom_sf(size=0.1, color="white") + # Thin white outline
  coord_sf(datum=NA) +               # Remove graticule lines
  scale_fill_manual(values = c(      # Manual hex colors
    "Mailbox, Litter Intervention" = "#342c5c",
    "Mailbox"                      = "#458490",
    "Litter Intervention"          = "#905145",
    "No Letters"                   = "grey",
    "Only Letters"                 = "#cbd3a3")) +
  theme_minimal(base_size = 20)      # Large text
```

---

```{r, echo=FALSE, dev="svg", fig.height=6.15}
load("seattle_tracts.RData")

ggplot(seattle_tracts, aes(fill=Experiment)) + 
  geom_sf(size=0.1, color="white") + # Thin white outline
  coord_sf(datum=NA) + # Remove graticule lines
  scale_fill_manual(values = c(
    "Mailbox, Litter Intervention" = "#342c5c",
    "Mailbox" = "#458490",
    "Litter Intervention" = "#905145",
    "No Letters" = "grey",
    "Only Letters" = "#cbd3a3")) +
  theme_minimal(base_size = 20)
```